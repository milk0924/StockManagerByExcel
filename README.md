# StockManagerByExcel

## 1.概要
本プロジェクトは，Excelでの実務処理をPythonで自動化・効率化するための手法を学ぶために開発されました．
DX化が進む現代において，現場で利用されることの多いExcel操作をプログラムへ置き換える練習として，「在庫管理」を題材にしています．
また，将来的なデータベース運用を見据え，Pythonとデータを紐づけて，一元管理する設計思想を反映させています．

## 2.機能
### 在庫の管理
1. **自動在庫更新**:Pythonを通して履歴ファイルに追加すると，自動的にマスタファイルの在庫数が変動します．
2. **在庫アラート**:最低個数アラートを設定し，在庫がそれ以下になったときに通知を出します．
### 商品の管理
1. **一覧照会**:マスタファイルで現在抱える商品の一覧や，その在庫数等を確認できます．
2. **マスタ編集**:マスタ情報を編集することができ，入力ミス担当者や引継ぎなどにも対応可能できます．
### 共通の仕様
1. **認証システム**:すべてのファイル変更時にパスワードを要求します．
2. **操作ログの自動記録**:「誰が・いつ・どのような操作をしたか」を自動で記録し．情報の透明性を確保します．
## 3.システムフロー
本プログラムはPythonをエンジンとし，Excelをデータベースとして利用します．
1. **認証**:実行時にパスワードを入力します．```person```シートの情報と照合します．
2. **処理選択**:メニューから「履歴追加」「マスタ編集」などを選択します．
3. **データ更新**:
    - 履歴追加時:```log```シートに追記し，```master```シートの在庫数，総入荷数，総出荷数を再計算します．
    - マスタ編集時:```master```シートを更新し，```master_log```に変更記録を記録します．
4. **保存**:処理完了後，Excelファイルを上書き保存します．

## 4.実行環境
- Python 3.13.5
### 外部ライブラリ
- openpyxl(Excel操作用)
## 5.使い方
1. ライブラリのインストール
    ターミナルで以下のコマンドを実行してください．
    ```Bash
    pip install openpyxl
    ```
2. ファイルの準備
    1.  template_stock_manager.xlsxに以下の情報を書き込む
        - personシート
            - **入力者（漢字）**：操作者の氏名
            - **パスワード** ：認証用パスワード(**必ず半角数字で入力**)
    2. ファイル名を```stock_manager.xlsx```に変更する．
3. プログラムの起動
    ```Bash
    Python main.py
    ```
    で起動．
4. 操作の流れ
    1. どのメニューを行うか選択肢が出るのでまずは0を入力して，終了できるか試してください．
    2. 5のマスタの登録を選択し，マスタに必要な情報を入力してください．その後，一度stock_manager.xlsxを開き正しく入力されているか確認してください.
    **次の操作を行うときは，ファイルを閉じることを忘れないようにしてください．**
    3. 以降，履歴の追加やマスタの編集をおこなってください．
## 6.ファイル構成
```
StockManagerByExcel/
|-- main.py                       # メインプログラム
|-- README.md                     # 本説明書
|-- template_stock_manager.xlsx   # 初期設定用テンプレート
`-- test_stock_manager.xlsx       # 動作確認用サンプルデータ
```

## 7.Excel各シートの仕様詳細

入力ルールや自動更新される項目の詳細です。

### ■ master シート（在庫管理メイン）
| 列名 | 入力制限 | 備考 |
| :--- | :--- | :--- |
| **ID** | 数字 | 商品識別用のユニークな番号 |
| **商品名** | 文字列 | 商品の名前 |
| **単位** | 文字列 | 個、本、台など |
| **在庫** | 数字 | 現在の在庫数（履歴から自動計算） |
| **最低個数アラート** | 数字 | この値を下回ると通知を表示 |
| **総入荷数** | 数字 | 累計の入荷数（自動計算） |
| **総出荷数** | 数字 | 累計の出荷数（自動計算） |
| **最終更新日時** | 自動入力 | 最後に操作された日時 |
| **最終更新人物** | 自動入力 | 最後に操作した人物 |

### ■ log シート（入出庫履歴）
| 列名 | 入力制限 | 備考 |
| :--- | :--- | :--- |
| **ID** | 数字 | masterシートのIDと一致させる |
| **変動数** | 数字 | 入荷はプラス（例: 10）、出荷はマイナス（例: -5） |
| **入力日時** | 自動入力 | 操作が行われた日時 |
| **入力人物** | 自動入力 | パスワード認証で特定された氏名 |
| **メモ** | 文字列 | 備考（任意入力） |

### ■ master_log シート（設定変更履歴）
| 列名 | 入力制限 | 備考 |
| :--- | :--- | :--- |
| **ID** | 数字 | 編集対象の商品のID |
| **更新日時** | 自動入力 | 編集が行われた日時 |
| **更新人物** | 自動入力 | 編集を行った人物 |
| **更新内容** | 自動入力 | 「在庫数: 10 -> 15」などの変更内容 |

### ■ person シート（利用者認証）
| 列名 | 入力制限 | 備考 |
| :--- | :--- | :--- |
| **入力者（漢字）** | 文字列 | 履歴に記録される正式名称 |
| **入力者（カナ）** | 文字列 | フリガナ |
| **パスワード** | **半角数字のみ** | **認証用。数字以外を入れるとエラーになります** |

## 8.注意事項
- **Excelの排他制御**: プログラムから書き込みを行う際，Excelファイルを開いているとエラーが発生します．**操作前に必ずExcelファイルを閉じてください．**

- **データ整合性**: IDの重複や、数値項目への文字列入力は予期せぬ動作の原因となります。
## 9.今後の予定
- 型ヒントを用いたより厳密な型の制御
- Docコメントの追加
- エラーハンドリングの強化
- Excelファイルの動的な取得
- シート名の自動取得
- パスワードシートを分離して，読み取る．
- GUI化
- 実行時のログを.txtで出力

